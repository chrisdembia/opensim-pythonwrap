<?xml version="1.0" encoding="UTF-8"?>
<PerturbationTool name="gait2392_walk1">
	<model_library> gait23 </model_library>
	<model_file> gait2392_sdfast_adjusted.osim </model_file>
	<replace_actuator_set> false </replace_actuator_set>
	<actuator_set_files>gait2392_CMC_Actuators.xml</actuator_set_files>
	<results_directory> ./ResultsPerturb </results_directory>

	<!-- Basic simulation paramters -->
	<output_precision> 12 </output_precision>
	<initial_time> 0.63 </initial_time>
	<final_time> 1.20 </final_time>

	<perturbation_time_window> 0.03 </perturbation_time_window>
	<perturbation_time_increment> 0.01 </perturbation_time_increment>
	<perturbation_size> 1 </perturbation_size>
	
	<!-- Integrator settings -->
	<maximum_number_of_integrator_steps> 20000 </maximum_number_of_integrator_steps>
	<maximum_integrator_step_size> 1.0e-4 </maximum_integrator_step_size>
	<integrator_error_tolerance> 1.0e-7 </integrator_error_tolerance>
	<integrator_fine_tolerance>  1.0e-10 </integrator_fine_tolerance>
	
	<!-- Corrective springs paramters -->
	<scaling_rise_time> 0.001 </scaling_rise_time>
	<corrective_spring_linear_stiffness> 5.0e6 5.0e6 5.0e6 </corrective_spring_linear_stiffness>
	<corrective_spring_linear_damping> 1.5e3 1.5e3 1.5e3 </corrective_spring_linear_damping>
	<corrective_spring_torsional_stiffness> 1.0e5 1.0e5 1.0e5 </corrective_spring_torsional_stiffness>
	<corrective_spring_torsional_damping> 1.0e3 1.0e3 1.0e3 </corrective_spring_torsional_damping>
	
	<!-- Input files -->
	<controls_file> ResultsCMC/gait2392_walk1_controls.xml </controls_file>
	<cop_file> gait2392_walk1_grf.mot </cop_file>
	<coordinates_file> ResultsCMC/gait2392_walk1_Kinematics_q.sto </coordinates_file>
	<speeds_file> ResultsCMC/gait2392_walk1_Kinematics_u.sto </speeds_file>
	<states_file> ResultsCMC/gait2392_walk1_states.sto </states_file>
	
	<!-- Foot contact event times - approximated from animation -->
	<r_heel_strike> 0.63 </r_heel_strike>
	<r_foot_flat>   0.75 </r_foot_flat>
	<r_heel_off>    1.20 </r_heel_off>
	<r_toe_off>     1.40 </r_toe_off>
	<l_heel_strike> 1.28 </l_heel_strike>
	<l_foot_flat>   1.38 </l_foot_flat>
	<l_heel_off>    1.80 </l_heel_off>
	<l_toe_off>     2.00 </l_toe_off>

	<!-- Ground reaction forces -->
	<external_loads_file> gait2392_walk1_grf.mot </external_loads_file>
	<external_loads_model_kinematics_file> gait2392_walk1_ik.mot </external_loads_model_kinematics_file>
	<external_loads_body1> calcn_r </external_loads_body1>
	<external_loads_body2> calcn_l </external_loads_body2>
	<lowpass_cutoff_frequency_for_load_kinematics> 6.0 </lowpass_cutoff_frequency_for_load_kinematics>

	<AnalysisSet name="Analyses">
		<objects>
			<Kinematics name="Kinematics">
				<on> true </on>
				<step_interval> 10 </step_interval>
				<in_degrees> true </in_degrees>
				<coordinates> knee_angle_l knee_angle_r </coordinates>
			</Kinematics>
			<BodyKinematics name="BodyKinematics">
				<on> true </on>
				<step_interval> 10 </step_interval>
				<in_degrees> true </in_degrees>
				<bodies> center_of_mass </bodies>
			</BodyKinematics>
		</objects>
	</AnalysisSet>
</PerturbationTool>

