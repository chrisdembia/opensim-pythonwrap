<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">
<link rel=File-List href="SubjectSpecificWorkflow_files/filelist.xml">
<title>Steps to prepare a new subject model (xxx is to be replaced with actual
name s26, n187):</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Ayman Habib</o:Author>
  <o:LastAuthor>Ayman Habib</o:LastAuthor>
  <o:Revision>6</o:Revision>
  <o:TotalTime>5071</o:TotalTime>
  <o:LastPrinted>2005-01-25T20:03:00Z</o:LastPrinted>
  <o:Created>2005-02-01T23:18:00Z</o:Created>
  <o:LastSaved>2005-02-02T01:15:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>1366</o:Words>
  <o:Characters>7790</o:Characters>
  <o:Company>Stanford University</o:Company>
  <o:Lines>64</o:Lines>
  <o:Paragraphs>18</o:Paragraphs>
  <o:CharactersWithSpaces>9138</o:CharactersWithSpaces>
  <o:Version>11.5703</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:Zoom>150</w:Zoom>
  <w:DontDisplayPageBoundaries/>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:PunctuationKerning/>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:Compatibility>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:DontGrowAutofit/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]-->
<style>
<!--
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	mso-style-next:"Heading 3";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
h1
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:16.0pt;
	font-family:Arial;
	mso-font-kerning:16.0pt;}
h2
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:14.0pt;
	font-family:Arial;
	font-style:italic;}
h3
	{mso-style-link:"Heading 3 Char";
	mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:13.0pt;
	font-family:Arial;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-locked:yes;
	mso-style-link:"Heading 3";
	mso-ansi-font-size:13.0pt;
	mso-bidi-font-size:13.0pt;
	font-family:Arial;
	mso-ascii-font-family:Arial;
	mso-hansi-font-family:Arial;
	mso-bidi-font-family:Arial;
	mso-ansi-language:EN-US;
	mso-fareast-language:EN-US;
	mso-bidi-language:AR-SA;
	font-weight:bold;}
span.SpellE
	{mso-style-name:"";
	mso-spl-e:yes;}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:20403651;
	mso-list-type:hybrid;
	mso-list-template-ids:-670151368 67698703 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l0:level1
	{mso-level-tab-stop:1.25in;
	mso-level-number-position:left;
	margin-left:1.25in;
	text-indent:-.25in;}
@list l0:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:1.75in;
	mso-level-number-position:left;
	margin-left:1.75in;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l0:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1
	{mso-list-id:110168980;
	mso-list-type:hybrid;
	mso-list-template-ids:-517686716 67698703 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l1:level1
	{mso-level-tab-stop:1.25in;
	mso-level-number-position:left;
	margin-left:1.25in;
	text-indent:-.25in;}
@list l1:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:1.75in;
	mso-level-number-position:left;
	margin-left:1.75in;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l1:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2
	{mso-list-id:174809023;
	mso-list-type:hybrid;
	mso-list-template-ids:-2066318190 67698703 67698691 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l2:level1
	{mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l2:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3
	{mso-list-id:1030881800;
	mso-list-type:hybrid;
	mso-list-template-ids:1805814970 67698691 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l3:level1
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	margin-left:1.0in;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l3:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	margin-left:1.5in;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l3:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4
	{mso-list-id:1280720734;
	mso-list-type:hybrid;
	mso-list-template-ids:-1867980584 67698703 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l4:level1
	{mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l4:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l5
	{mso-list-id:1317145132;
	mso-list-type:hybrid;
	mso-list-template-ids:-1250647726 67698703 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l5:level1
	{mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l5:level2
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l5:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l5:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l5:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l5:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l5:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l5:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l5:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
table.MsoTableGrid
	{mso-style-name:"Table Grid";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	border:solid windowtext 1.0pt;
	mso-border-alt:solid windowtext .5pt;
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-border-insideh:.5pt solid windowtext;
	mso-border-insidev:.5pt solid windowtext;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]-->
</head>

<body lang=EN-US link=blue vlink=purple style='tab-interval:.5in'>

<div class=Section1>

<h1>Subject specific simulation workflow</h1>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>This document is intended as a documentation of the steps
that need to be taken by researchers trying to create and analyze subject
specific simulations. The document is a work in progress and should be amended
whenever new info that helps customize/improve the workflow becomes available.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h3><a name="_Workflow_outline"></a>Workflow outline</h3>

<ol style='margin-top:0in' start=1 type=1>
 <li class=MsoNormal style='mso-list:l4 level1 lfo1;tab-stops:list .5in'>Subject
     specific motion capture data is obtained from one of the collaborating
     hospitals/centers and preprocessed to match the assumptions in the
     workflow, this preprocessing is not yet covered in this document. </li>
 <li class=MsoNormal style='mso-list:l4 level1 lfo1;tab-stops:list .5in'>Motion
     capture data is used to scale a standard nominal model (that has been
     tested and validated) to match the size of the subject. We’ll call it
     subject-model. (<a href="#runDarrylsScripts">step</a>)</li>
 <li class=MsoNormal style='mso-list:l4 level1 lfo1;tab-stops:list .5in'>Inverse
     kinematics is used to calculate joint kinematics that best reproduce
     experimental data using the subject-model. This is done by minimizing the
     weighted sum of errors in a set of markers for each frame of the motion. (<a
     href="#runDarrylsScripts">step</a>)</li>
 <li class=MsoNormal style='mso-list:l4 level1 lfo1;tab-stops:list .5in'>The
     motion that results from inverse kinematics will generally be not
     dynamically consistent with measured ground reaction forces, REA (Residual
     Elimination Algorithm) is performed on the motion resulting from inverse
     kinematics to adjust few generalized coordinates (back angles and pelvis
     translations) to make the motion dynamically consistent with measured
     ground reaction forces. (<a href="#runDarrylsScripts">step</a>)</li>
 <li class=MsoNormal style='mso-list:l4 level1 lfo1;tab-stops:list .5in'>With
     dynamically consistent motion and ground reaction forces, computed muscle
     control (CMC) is used to compute muscle excitations to drive the model
     through the motion. The output of CMC is a SIMM motion file that contains
     a set of muscle excitations. (<a href="#runDarrylsScripts">step</a>)</li>
 <li class=MsoNormal style='mso-list:l4 level1 lfo1;tab-stops:list .5in'>An
     open loop forward simulation is performed using the subject-model, muscle
     excitations from previous step. Analyses can be attached to the forward
     simulation to record quantities of interest. (<a href="#runAndAnalyze">step</a>)</li>
</ol>

<h3>Prerequisites</h3>

<ol style='margin-top:0in' start=1 type=1>
 <li class=MsoNormal style='mso-list:l2 level1 lfo2;tab-stops:list .5in'>You
     have to have the RDI platform installed which includes:</li>
 <ul style='margin-top:0in' type=circle>
  <li class=MsoNormal style='mso-list:l2 level2 lfo2;tab-stops:list 1.0in'><span
      class=SpellE>Cygwin</span> (modules: <span class=SpellE>cvs</span>, <span
      class=SpellE>perl</span> )</li>
  <li class=MsoNormal style='mso-list:l2 level2 lfo2;tab-stops:list 1.0in'>Microsoft
      Developer Studio (version 7.1 or version 6.0).</li>
  <li class=MsoNormal style='mso-list:l2 level2 lfo2;tab-stops:list 1.0in'>RDI
      source code repository (directory /Source/RD).</li>
  <li class=MsoNormal style='mso-list:l2 level2 lfo2;tab-stops:list 1.0in'><span
      class=SpellE>Nmbl</span> source code repository (directory /Source/SU)</li>
  <li class=MsoNormal style='mso-list:l2 level2 lfo2;tab-stops:list 1.0in'>Environment
      variables are set properly per the RDI installation, in particular.</li>
  <ol style='margin-top:0in' start=1 type=1>
   <li class=MsoNormal style='mso-list:l2 level3 lfo2;tab-stops:list 1.5in'>RDI_DEV=source
       code repository root directory, </li>
   <li class=MsoNormal style='mso-list:l2 level3 lfo2;tab-stops:list 1.5in'>RDI_INSTALL=Root
       directory for RDI install on your machine, </li>
   <li class=MsoNormal style='mso-list:l2 level3 lfo2;tab-stops:list 1.5in'>ARCH=VC71
       or VC6 (depending on your <span class=SpellE>DevStudio</span> version).</li>
  </ol>
 </ul>
 <li class=MsoNormal style='mso-list:l2 level1 lfo2;tab-stops:list .5in'>Build
     the following libraries, or get them from the RDI distribution (If you get
     ready made libraries make sure they correspond to your <span class=SpellE>DevStudio</span>
     version). Place the libraries under $LibDev/VC71D/ ($LibDev/VC6D/) for
     version 7.1 (6). <span class=SpellE>Prebuilt</span> libraries for both
     VC71 and VC6 will be made available under $RDI_INSTALL/Lib/$ARCH</li>
</ol>

<h3><o:p>&nbsp;</o:p></h3>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='margin-left:53.6pt;border-collapse:collapse;border:none;mso-border-alt:
 solid windowtext .5pt;mso-yfti-tbllook:480;mso-padding-alt:0in 5.4pt 0in 5.4pt;
 mso-border-insideh:.5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=156 valign=top style='width:117.0pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><i style='mso-bidi-font-style:normal'><span
  style='font-size:9.0pt'>Library name<o:p></o:p></span></i></p>
  </td>
  <td width=192 valign=top style='width:2.0in;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=SpellE><i style='mso-bidi-font-style:normal'><span
  style='font-size:9.0pt'>DevStudio</span></i></span><i style='mso-bidi-font-style:
  normal'><span style='font-size:9.0pt'> Project<o:p></o:p></span></i></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=156 valign=top style='width:117.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=SpellE><span style='font-size:9.0pt'>rdTools_D.lib</span></span><span
  style='font-size:9.0pt'><o:p></o:p></span></p>
  </td>
  <td width=192 valign=top style='width:2.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=SpellE><span style='font-size:9.0pt'>RDLibraries/rdTools</span></span><span
  style='font-size:9.0pt'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=156 valign=top style='width:117.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=SpellE><span style='font-size:9.0pt'>rdSimulation_D.lib</span></span><span
  style='font-size:9.0pt'><o:p></o:p></span></p>
  </td>
  <td width=192 valign=top style='width:2.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=SpellE><span style='font-size:9.0pt'>RDLibraries/rdSimulation</span></span><span
  style='font-size:9.0pt'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=156 valign=top style='width:117.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=SpellE><span style='font-size:9.0pt'>rdSDFast_D.lib</span></span><span
  style='font-size:9.0pt'><o:p></o:p></span></p>
  </td>
  <td width=192 valign=top style='width:2.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=SpellE><span style='font-size:9.0pt'>RDLibraries/rdSDFast</span></span><span
  style='font-size:9.0pt'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=156 valign=top style='width:117.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='font-size:9.0pt'>suPipeline40_D.lib<o:p></o:p></span></p>
  </td>
  <td width=192 valign=top style='width:2.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='font-size:9.0pt'>SULibraries/suPipeline40<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width=156 valign=top style='width:117.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='font-size:9.0pt'>suPipeline40Workflow_D.lib<o:p></o:p></span></p>
  </td>
  <td width=192 valign=top style='width:2.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='font-size:9.0pt'>SULibraries/suPipeline40Workflow<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td width=156 valign=top style='width:117.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=SpellE><span style='font-size:9.0pt'>suAnalyses_D.lib</span></span><span
  style='font-size:9.0pt'><o:p></o:p></span></p>
  </td>
  <td width=192 valign=top style='width:2.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=SpellE><span style='font-size:9.0pt'>SULibraries/suAnalyses</span></span><span
  style='font-size:9.0pt'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7;mso-yfti-lastrow:yes'>
  <td width=156 valign=top style='width:117.0pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=SpellE><span style='font-size:9.0pt'>Acpp_D.lib</span></span><span
  style='font-size:9.0pt'><o:p></o:p></span></p>
  </td>
  <td width=192 valign=top style='width:2.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='font-size:9.0pt'>$RDI_INSTALL/Lib/$Arch<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span class=Heading3Char><span style='font-size:13.0pt'>Directory
structure &amp; file descriptions</span></span></p>

<p class=MsoNormal>Users can create arbitrary directories to contain subject specific
data files and executables. No assumptions are made about where this directory
is located. Darryl’s code generates a directory for every subject that contains
data files under the name data/xxx where xxx is the name of the subject. We’ll
call this directory <span class=SpellE><i style='mso-bidi-font-style:normal'>SubjectDirectory</i></span>.
The subject directory will contain files generated by the preprocessing steps
of Darryl as well as the files created by SIMM and <span class=SpellE>SDFast</span>.
Only a few of these files are relevant to creating and running forward
simulations. A brief description of these relevant files follows:</p>

<p class=MsoNormal style='margin-left:1.0in;text-indent:-.25in;mso-list:l3 level1 lfo3;
tab-stops:list 1.0in'><![if !supportLists]><span style='font-family:"Courier New";
mso-fareast-font-family:"Courier New"'><span style='mso-list:Ignore'>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]>Source
code files:</p>

<p class=MsoNormal style='margin-left:1.25in;text-indent:-.25in;mso-list:l0 level1 lfo4;
tab-stops:list 1.25in'><![if !supportLists]><span style='mso-list:Ignore'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]><span
class=SpellE>suxxx.cpp</span>, <span class=SpellE>suxxx.h</span> (Created by
the script in <a href="#runMakeprojectScript">step</a>.<span
style='mso-spacerun:yes'>  </span>File usage: wrapper to make the model into a
c++ class to be used for simulation in RDI platform).</p>

<p class=MsoNormal style='margin-left:1.25in;text-indent:-.25in;mso-list:l0 level1 lfo4;
tab-stops:list 1.25in'><![if !supportLists]><span style='mso-list:Ignore'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]><span
class=SpellE>suxxx_Forward.cpp</span> (Created by the script in <a
href="#runMakeprojectScript">step</a>. File usage: driver for the forward
simulation that instantiates the model, controls, analyses and runs the
simulation).</p>

<p class=MsoNormal style='margin-left:1.25in;text-indent:-.25in;mso-list:l0 level1 lfo4;
tab-stops:list 1.25in'><![if !supportLists]><span style='mso-list:Ignore'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]><span
class=SpellE>sdufuncs_darryl.c</span> (Created by the script in <a
href="#runMakeprojectScript">step</a>. File usage: collection of functions used
to initialize <span class=SpellE>sdfast</span> and functions to be called by <span
class=SpellE>sdfast</span> for calculation of derivatives, constraints, <span
class=GramE>forces,..</span> It includes changes made by Darryl. This file is
not subject specific but left at this level for potential modification).</p>

<p class=MsoNormal style='margin-left:1.25in;text-indent:-.25in;mso-list:l0 level1 lfo4;
tab-stops:list 1.25in'><![if !supportLists]><span style='mso-list:Ignore'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]><span
class=SpellE>sdfor.c</span>, (Created by SIMM in <a href="#generateDyn">step</a>).</p>

<p class=MsoNormal style='margin-left:1.25in;text-indent:-.25in;mso-list:l0 level1 lfo4;
tab-stops:list 1.25in'><![if !supportLists]><span style='mso-list:Ignore'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]><span
class=SpellE>xxx_dyn.c</span>, <span class=SpellE>xxx_sar.c</span> (Created in <a
href="#runSDFast">step</a> by <span class=SpellE>sdfast</span> based on the system
description file <span class=SpellE>model.sd</span> generated by SIMM in <a
href="#generateDyn">step</a>. File usage: along with <span class=SpellE>sdfor.c</span>
these three files describe the dynamic behavior of the model and implement the
equations of motion specific to the subject).</p>

<p class=MsoNormal style='margin-left:1.0in;text-indent:-.25in;mso-list:l3 level1 lfo3;
tab-stops:list 1.0in'><![if !supportLists]><span style='font-family:"Courier New";
mso-fareast-font-family:"Courier New"'><span style='mso-list:Ignore'>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]>Data
files:</p>

<p class=MsoNormal style='margin-left:1.25in;text-indent:-.25in;mso-list:l1 level1 lfo5;
tab-stops:list 1.25in'><![if !supportLists]><span style='mso-list:Ignore'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]><span
class=SpellE>xxx.jnt</span>, <span class=SpellE>xxx.msl</span> (SIMM joint and
muscle files created in <a href="#runDarrylsScripts">step</a>).</p>

<p class=MsoNormal style='margin-left:1.25in;text-indent:-.25in;mso-list:l1 level1 lfo5;
tab-stops:list 1.25in'><![if !supportLists]><span style='mso-list:Ignore'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]><span
class=SpellE>xxxcmc.mot</span> (motion file output of <span class=SpellE>cmc</span>,
including muscle excitations computed in <a href="#runDarrylsScripts">step</a>).</p>

<p class=MsoNormal style='margin-left:1.25in;text-indent:-.25in;mso-list:l1 level1 lfo5;
tab-stops:list 1.25in'><![if !supportLists]><span style='mso-list:Ignore'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]><span
class=SpellE>xxxcmc.ctr</span> (muscle excitations extracted from <span
class=SpellE>xxxcmc.mot</span> in xml format. This file is created in <a
href="#extractControls">step</a>).</p>

<p class=MsoNormal style='margin-left:1.25in;text-indent:-.25in;mso-list:l1 level1 lfo5;
tab-stops:list 1.25in'><![if !supportLists]><span style='mso-list:Ignore'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]>params.txt
(parameters used to initialize the model including muscle file name, and motion
file to initialize positions, velocities and accelerations. Created by SIMM in <a
href="#generateDyn">step</a>).</p>

<p class=MsoNormal style='margin-left:1.0in;text-indent:-.25in;mso-list:l3 level1 lfo3;
tab-stops:list 1.0in'><![if !supportLists]><span style='font-family:"Courier New";
mso-fareast-font-family:"Courier New"'><span style='mso-list:Ignore'>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]>Support
files to build the executables needed to execute all the steps: (*.<span
class=SpellE>sln</span> *.<span class=SpellE>vcproj</span>, *.<span
class=SpellE>dsp</span>, *.<span class=SpellE>dsw</span>)</p>

<h2>Steps: </h2>

<p class=MsoNormal>In the following steps, “xxx” should be replaced with an actual
subject name (e.g. s26, n187). Names are case sensitive, use small letters when
prompted for model name. Model names can include underscores and have no length
restrictions so you can use n123_05 for version 5 of the model for subject
n123, you just need to make sure that the muscle, joint and control files all
observe the same naming. </p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Item 1 in the <a href="#_Workflow_outline">workflow outline</a>
(preprocessing) is not accounted for in these steps. Items 2-5 of the outline
are done using Darryl’s provided scripts. Customization and tuning of these
scripts is still underway. The steps below target item 6 of the workflow
outline (running and analyzing a forward simulation of the subject model). To
build and run the executable that simulates the subject model we need to:</p>

<p class=MsoNormal style='margin-left:1.0in;text-indent:-.25in;mso-list:l3 level1 lfo3;
tab-stops:list 1.0in'><![if !supportLists]><span style='font-family:"Courier New";
mso-fareast-font-family:"Courier New"'><span style='mso-list:Ignore'>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]>Setup
input files for simulation (Steps 1, 3 below)</p>

<p class=MsoNormal style='margin-left:1.0in;text-indent:-.25in;mso-list:l3 level1 lfo3;
tab-stops:list 1.0in'><![if !supportLists]><span style='font-family:"Courier New";
mso-fareast-font-family:"Courier New"'><span style='mso-list:Ignore'>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]>Generate
equations of motion for the subject from SIMM model. (Steps 4-6)</p>

<p class=MsoNormal style='margin-left:1.0in;text-indent:-.25in;mso-list:l3 level1 lfo3;
tab-stops:list 1.0in'><![if !supportLists]><span style='font-family:"Courier New";
mso-fareast-font-family:"Courier New"'><span style='mso-list:Ignore'>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]>Wrap
equations of motion into C++ class. (Automated in Step 2)</p>

<p class=MsoNormal style='margin-left:1.0in;text-indent:-.25in;mso-list:l3 level1 lfo3;
tab-stops:list 1.0in'><![if !supportLists]><span style='font-family:"Courier New";
mso-fareast-font-family:"Courier New"'><span style='mso-list:Ignore'>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]>Properly
initialize the model (Step 7)</p>

<p class=MsoNormal style='margin-left:1.0in;text-indent:-.25in;mso-list:l3 level1 lfo3;
tab-stops:list 1.0in'><![if !supportLists]><span style='font-family:"Courier New";
mso-fareast-font-family:"Courier New"'><span style='mso-list:Ignore'>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]>Write
main program to instantiate the model, launch simulation and add analyses to
it. (Automated in Step 2)</p>

<p class=MsoNormal style='margin-left:1.0in;text-indent:-.25in;mso-list:l3 level1 lfo3;
tab-stops:list 1.0in'><![if !supportLists]><span style='font-family:"Courier New";
mso-fareast-font-family:"Courier New"'><span style='mso-list:Ignore'>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]>Build
and run the simulation (Steps 8-9).</p>

<h3><span style='font-size:12.0pt;font-family:"Times New Roman";mso-bidi-font-family:
Arial;font-weight:normal;mso-bidi-font-weight:bold'>The rest of the steps move
files around to have them in the proper directory for simulation.<o:p></o:p></span></h3>

<ol style='margin-top:0in' start=1 type=1>
 <li class=MsoNormal style='mso-list:l5 level1 lfo6;tab-stops:list .5in'><a
     name=runDarrylsScripts>Run Darryl’s scripts </a>to create subject
     directory (xxx) and create the files <span class=SpellE>xxx.jnt</span>, <span
     class=SpellE>xxx.msl</span>, <span class=SpellE>xxxcmc.mot</span> in it.</li>
 <li class=MsoNormal style='mso-list:l5 level1 lfo6;tab-stops:list .5in'><a
     name=runMakeprojectScript>Change to subject directory (xxx) and run the script</a>
     makeProject.pl from repository using command: <span class=SpellE><b
     style='mso-bidi-font-weight:normal'><i style='mso-bidi-font-style:normal'>perl</i></b></span><b
     style='mso-bidi-font-weight:normal'><i style='mso-bidi-font-style:normal'>
     $RDI_DEV/</i></b><i style='mso-bidi-font-style:normal'> <b
     style='mso-bidi-font-weight:normal'>Source/Native/SU/Models/Subjects/makeProject.pl</b></i>.
     This adds the following source files to the subject directory (<span
     class=SpellE>suxxx.cpp</span>, <span class=SpellE>suxxx.h</span>, <span
     class=SpellE>suxxx_Forward.cpp</span>, <span class=SpellE>sdufuncs_darryl.c</span>).
     It also creates Microsoft project files to build the forward simulation executable
     (<span class=SpellE>suxxx.sln</span> &amp; <span class=SpellE>suxxx.vcproj</span>)
     for version 7.1 (<span class=SpellE>suxxx.dsw</span>/ <span class=SpellE>suxxx.dsp</span>
     for version 6).</li>
 <li class=MsoNormal style='mso-list:l5 level1 lfo6;tab-stops:list .5in'><a
     name=extractControls>Run the executable </a>that extracts controls from
     the <span class=SpellE>xxxcmc.mot</span> file in the subject directory as
     follows: <span class=GramE><b style='mso-bidi-font-weight:normal'><i
     style='mso-bidi-font-style:normal'>$RDI_DEV/Source/Native/RD/Utilities/rdConvertStorageToControls_D.exe
     <span class=SpellE>xxxcmc.mot</span> glut_med1_r_exc 92 <span
     class=SpellE>xxxcmc.ctr</span></i></b></span><b style='mso-bidi-font-weight:
     normal'><i style='mso-bidi-font-style:normal'>. </i></b>This will generate
     a file of muscle excitations <span class=SpellE>xxxcmc.ctr</span> in the
     subject directory. You can also use pre-built executable from
     ($RDI_INSTALL/Bin/$Arch/rdConvertStorageToControls_D.exe) instead.</li>
 <li class=MsoNormal style='mso-list:l5 level1 lfo6;tab-stops:list .5in'><a
     name=generateDyn>Start SIMM4.0 and </a>open the files <span class=SpellE>xxx.jnt</span>
     &amp; <span class=SpellE>xxx.msl</span> from step 1. (Some bone files may
     be missing though this does not affect results).</li>
 <li class=MsoNormal style='mso-list:l5 level1 lfo6;tab-stops:list .5in'>Select
     File/<span class=SpellE>SaveDynamics</span> and check all checkboxes, save
     to the default xxx directory. This generates a lot of files and
     directories needed to run the simulation in SIMM but these are not
     relevant for the workflow except for (params.txt, <span class=SpellE>dynsim/src/model.sd</span>
     and <span class=SpellE>dynsim/src/sdfor.c</span>)</li>
 <li class=MsoNormal style='mso-list:l5 level1 lfo6;tab-stops:list .5in'><a
     name=runSDFast>Run </a><span class=SpellE><span style='mso-bookmark:runSDFast'>sdfast</span></span><span
     style='mso-bookmark:runSDFast'> </span>(on Hill) on the input file <span
     class=SpellE>dynsim/src/model.sd</span> to generate files <span
     class=SpellE>xxx_dyn.c</span>, <span class=SpellE>xxx_sar.c</span> and
     copy them back to the subject directory (xxx). </li>
 <li class=MsoNormal style='mso-list:l5 level1 lfo6;tab-stops:list .5in'><a
     name=buildsimulator>Add the line “</a><span class=SpellE><span
     style='mso-bookmark:buildsimulator'>kinetics_file</span></span><span
     style='mso-bookmark:buildsimulator'> <span class=SpellE>xxxcmc.mot</span>”
     to the file params.txt created by SIMM in step 5 (at line 16 of the file).</span></li>
 <li class=MsoNormal style='mso-list:l5 level1 lfo6;tab-stops:list .5in'><span
     style='mso-bookmark:buildsimulator'>Build the executable </span>using <span
     class=SpellE><b style='mso-bidi-font-weight:normal'><i style='mso-bidi-font-style:
     normal'>devenv</i></b></span><b style='mso-bidi-font-weight:normal'><i
     style='mso-bidi-font-style:normal'> <span class=SpellE>suxxx.sln</span>
     /build Debug /project <span class=SpellE>suxxx.vcproj</span></i> </b>in
     the subject directory, this creates an executable suxxx.exe. (for vc6.0
     use ?? instead).</li>
 <li class=MsoNormal style='mso-list:l5 level1 lfo6;tab-stops:list .5in'><a
     name=runAndAnalyze>Run the executable </a>generated in previous step in
     the subject directory. Analysis results are stored under the Results
     subdirectory. You can view the motion in SIMM4 by changing the extension
     of the file Results/<span class=SpellE>xxx_Kinematics_q.sto</span> to .mot
     and open it in SIMM.</li>
</ol>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

</div>

</body>

</html>
